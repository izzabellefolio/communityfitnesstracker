<div class="container mt-4">

  <!-- HEADER -->
  <div class="card shadow-lg border-0 mb-4 header-card">
    <div class="card-body p-4 d-flex justify-content-between align-items-center">

      <div>
        <a routerLink="/routines" class="back-link">← Back</a>

        <h2 class="fw-bold mt-2 mb-1">Create Custom Routine</h2>

        <small class="opacity-75">
          Add exercises and schedule your routine
        </small>
      </div>

    </div>
  </div>

  <!-- FORM CARD -->
  <div class="card card-section fade-in shadow-sm border-0 rounded-4 mb-4 p-4">

    <!-- Step 1 -->
    <div class="mb-4">
      <h5 class="fw-bold mb-3">1. Basic Information</h5>

      <div class="mb-3">
        <label class="form-label text-dark fw-semibold">Routine Name *</label>
        <input 
          type="text" 
          class="form-control"
          [(ngModel)]="routineName"
          placeholder="e.g., Morning Full-Body Workout"
          style="border-radius: 10px; border: 1px solid rgba(69, 123, 157, 0.2);"
        >
      </div>

      <div class="mb-3">
        <label class="form-label text-dark fw-semibold">Description (Optional)</label>
        <textarea 
          class="form-control"
          rows="3"
          [(ngModel)]="routineDescription"
          placeholder="Describe your routine..."
          style="border-radius: 10px; border: 1px solid rgba(69, 123, 157, 0.2);"
        ></textarea>
      </div>
    </div>

    <hr class="my-4">

    <!-- Step 2 -->
    <div class="mb-4">
      <h5 class="fw-bold mb-3">2. Schedule</h5>

      <label class="form-label text-dark fw-semibold">Select Days *</label>
      <div class="d-flex flex-wrap gap-2 mb-3">
        <button 
          *ngFor="let day of daysOfWeek"
          type="button"
          class="btn fw-semibold"
          [style.background]="selectedDays.includes(day) ? 'linear-gradient(to right, #457B9D, #5d9cc6)' : '#ffffff'"
          [style.color]="selectedDays.includes(day) ? 'white' : '#457B9D'"
          style="border-radius: 20px; border: 1px solid #457B9D; padding: 0.5rem 1rem;"
          (click)="toggleDay(day)"
        >
          {{ day.substring(0, 3) }}
        </button>
      </div>

      <div>
        <label class="form-label text-dark fw-semibold">Time</label>
        <input 
          type="time" 
          class="form-control"
          [(ngModel)]="selectedTime"
          style="border-radius: 10px; border: 1px solid rgba(69, 123, 157, 0.2);"
        >
      </div>
    </div>

    <hr class="my-4">

    <!-- Step 3 -->
    <div class="mb-4">
      <h5 class="fw-bold mb-3">3. Add Exercises *</h5>

      <!-- Existing Exercise List -->
      <div *ngIf="exercises.length > 0" class="mb-3">
        <div class="list-group">
          <div 
            *ngFor="let ex of exercises; let i = index" 
            class="list-group-item"
            style="border-radius: 10px; margin-bottom: 8px; background: #f8f9fa; border: 1px solid rgba(69, 123, 157, 0.1);"
          >
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <strong class="text-dark">{{ ex.name }}</strong>
                <span class="badge bg-primary ms-2" style="background: linear-gradient(to right, #457B9D, #5d9cc6) !important;">{{ ex.type }}</span>
                <span class="badge bg-info ms-1">{{ ex.intensity }}</span>
                <br>
                <small class="text-muted">
                  {{ ex.sets }} sets × {{ ex.reps > 0 ? ex.reps + ' reps' : ex.duration + ' min' }}
                </small>
              </div>

              <button 
                type="button" 
                class="btn btn-sm btn-outline-danger fw-semibold"
                style="border-radius: 20px;"
                (click)="removeExercise(i)"
              >
                Remove
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Add Exercise Card -->
      <div class="card p-4" style="border-radius: 16px; background: #f8f9fa; border: 1px solid rgba(69, 123, 157, 0.1); box-shadow: 0 4px 12px rgba(69, 123, 157, 0.05);">
        <h6 class="fw-bold text-dark mb-3">Add Exercise</h6>

        <div class="row">
          <div class="col-md-6 mb-3">
            <label class="form-label text-dark fw-semibold">Exercise Name</label>
            <input 
              type="text" 
              class="form-control"
              [(ngModel)]="currentExercise.name"
              placeholder="e.g., Push-ups"
              style="border-radius: 10px; border: 1px solid rgba(69, 123, 157, 0.2);"
            >
          </div>

          <div class="col-md-6 mb-3">
            <label class="form-label text-dark fw-semibold">Type</label>
            <select class="form-select" [(ngModel)]="currentExercise.type" style="border-radius: 10px; border: 1px solid rgba(69, 123, 157, 0.2);">
              <option *ngFor="let type of exerciseTypes" [value]="type">{{ type }}</option>
            </select>
          </div>

          <div class="col-md-4 mb-3">
            <label class="form-label text-dark fw-semibold">Sets</label>
            <input 
              type="number" 
              class="form-control"
              [(ngModel)]="currentExercise.sets"
              min="1"
              style="border-radius: 10px; border: 1px solid rgba(69, 123, 157, 0.2);"
            >
          </div>

          <div class="col-md-4 mb-3">
            <label class="form-label text-dark fw-semibold">Reps</label>
            <input 
              type="number" 
              class="form-control"
              [(ngModel)]="currentExercise.reps"
              min="0"
              style="border-radius: 10px; border: 1px solid rgba(69, 123, 157, 0.2);"
            >
          </div>

          <div class="col-md-4 mb-3">
            <label class="form-label text-dark fw-semibold">Duration (min)</label>
            <input 
              type="number" 
              class="form-control"
              [(ngModel)]="currentExercise.duration"
              min="0"
              style="border-radius: 10px; border: 1px solid rgba(69, 123, 157, 0.2);"
            >
          </div>

          <div class="col-md-12 mb-3">
            <label class="form-label text-dark fw-semibold">Intensity</label>
            <select class="form-select" [(ngModel)]="currentExercise.intensity" style="border-radius: 10px; border: 1px solid rgba(69, 123, 157, 0.2);">
              <option *ngFor="let level of intensityLevels" [value]="level">{{ level }}</option>
            </select>
          </div>
        </div>

        <button 
          type="button" 
          class="btn text-white w-100 fw-semibold"
          style="background: linear-gradient(to right, #457B9D, #5d9cc6); border-radius: 10px;"
          (click)="addExercise()"
        >
          + Add Exercise
        </button>
      </div>
    </div>

    <!-- Footer Buttons -->
    <div class="d-flex justify-content-between mt-4 pt-3 border-top">
      <a routerLink="/routines" class="btn btn-outline-primary text-dark fw-semibold rounded-pill px-4">
        Cancel
      </a>

      <button 
        type="button" 
        class="btn text-white fw-semibold rounded-pill px-4"
        style="background: linear-gradient(to right, #457B9D, #5d9cc6);"
        (click)="saveRoutine()"
      >
        Save Routine
      </button>
    </div>

  </div>
</div>

<style>
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Inputs */
.soft-input {
  border-radius: 10px !important;
  border: 1px solid #c9d3ff !important;
  transition: 0.25s;
}
.soft-input:focus {
  border-color: #5a67d8 !important;
  box-shadow: 0 0 5px rgba(90, 103, 216, 0.3) !important;
}

/* Buttons */
.soft-btn {
  border-radius: 10px !important;
  transition: 0.25s;
}
.soft-btn:hover {
  opacity: 0.9;
}

/* List items */
.soft-list-item {
  border-radius: 10px;
  margin-bottom: 8px;
  background: #f7f9ff;
}

/* Exercise form sub-card */
.soft-subcard {
  border-radius: 12px;
  background: #f5f7ff;
  border: none;
  box-shadow: 0 4px 12px rgba(90, 103, 216, 0.1);
}
</style>

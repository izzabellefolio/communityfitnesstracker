<div class="container mt-4">

  <!-- Loading -->
  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-primary"></div>
    <p class="mt-3 text-muted">Loading your routines...</p>
  </div>

  <!-- ROUTINE LIST -->
  <div *ngIf="!loading" class="fade-in">

    <!-- HEADER -->
    <div class="card shadow-lg border-0 mb-4 header-card">
      <div class="card-body p-4 d-flex justify-content-between align-items-center">

        <div class="d-flex flex-column">
          <h2 class="fw-bold mb-1">My Routines</h2>
          <small class="opacity-75">Manage your custom routines</small>
        </div>

        <div class="d-flex align-items-center gap-2">
          <a 
            routerLink="/routines/premade" 
            class="btn btn-primary text-dark fw-semibold rounded-pill px-4 shadow-sm"
          >
            Premade
          </a>
          <a 
            routerLink="/routines/create" 
            class="btn btn-primary text-white fw-semibold rounded-pill px-4 shadow-sm"
          >
            New Routine
          </a>
        </div>
      </div>
    </div>

    <!-- Empty -->
    <div *ngIf="routines.length === 0" class="text-center py-5">
      <div class="empty-icon mb-3">ğŸ’ª</div>
      <h4 class="fw-bold">No Routines Yet</h4>
      <p class="text-muted">Create one or browse premade templates.</p>

      <a 
        routerLink="/routines/create" 
        class="btn btn-primary me-2 text-white fw-semibold rounded-pill px-4"
      >
        Create Routine
      </a>

      <a 
        routerLink="/routines/premade" 
        class="btn btn-outline-primary text-dark fw-semibold rounded-pill px-4"
      >
        Browse Routines
      </a>
    </div>

    <!-- ROUTINES GRID -->
    <div *ngIf="routines.length > 0" class="row g-4">
      <div *ngFor="let routine of routines" class="col-sm-6 col-md-4 col-lg-4">
        <div class="card card-section fade-in h-100 d-flex flex-column">

          <div class="card-body flex-grow-1">
            <h5 class="card-title fw-bold mb-2">{{ routine.name }}</h5>
            <p class="text-muted small mb-3" *ngIf="routine.description">
              {{ routine.description }}
            </p>

            <div class="small mb-3">
              <div class="mb-2">
                <strong class="text-dark">ğŸ“… Schedule:</strong>
                <span class="text-muted d-block">{{ routine.schedule.join(', ') }}</span>
              </div>
              <div>
                <strong class="text-dark">â±ï¸ Time:</strong>
                <span class="text-muted d-block">{{ routine.time }}</span>
              </div>
            </div>

            <hr class="my-3">

            <!-- Exercise Preview -->
            <div class="small mb-3">
              <strong class="text-dark">ğŸ’ª Exercises ({{ routine.exercises.length }})</strong>
              <ul class="ps-3 mb-0 small text-muted">
                <li *ngFor="let exercise of routine.exercises.slice(0, 3)">
                  <span class="fw-semibold">{{ exercise.name }}</span> - {{ exercise.sets }}x{{ exercise.reps || exercise.duration + 'min' }}
                </li>
              </ul>

              <small *ngIf="routine.exercises.length > 3" class="text-muted">
                + {{ routine.exercises.length - 3 }} more
              </small>
            </div>
          </div>

          <div class="card-footer bg-white border-top p-3">
            <!-- Actions -->
            <div class="d-flex gap-2">
              <a 
                [routerLink]="['/routines', routine.id]" 
                class="btn btn-outline-primary btn-sm text-dark fw-semibold flex-grow-1 rounded-pill"
              >
                View
              </a>

              <button 
                class="btn btn-outline-danger btn-sm fw-semibold flex-grow-1 rounded-pill"
                (click)="deleteRoutine(routine.id!)"
              >
                <span *ngIf="deletingId === routine.id" class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                Delete
              </button>
            </div>
          </div>

        </div>
      </div>
    </div>

  </div>
</div>